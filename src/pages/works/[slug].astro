---
import { getCollection, type CollectionEntry } from 'astro:content'
import { Image } from 'astro:assets'
import Layout from '../../layouts/Layout.astro'

export async function getStaticPaths() {
  const works = await getCollection('works')
  return works.map((work: any) => ({
    params: { slug: work.slug },
    props: { work },
  }))
}


type Props = {
  work: CollectionEntry<'works'>
}

const { work } = Astro.props
---

<Layout title={`${work.data.title} - QuickPhoneFix`}>
  <main class="min-h-screen bg-slate-950 text-white pt-24 pb-20">
    <article class="max-w-4xl mx-auto px-4">
      
      <a href="/#works" class="inline-flex items-center text-green-400 hover:text-green-300 mb-6">
        ← Volver a trabajos
      </a>
      
      <span class="text-sm text-green-400 font-semibold block mb-2">
        {work.data.phone}
      </span>
      
      <h1 class="text-4xl md:text-6xl font-black mb-4 bg-linear-to-r from-green-400 to-blue-400 bg-clip-text text-transparent">
        {work.data.title}
      </h1>
      
      <p class="text-xl text-slate-300 mb-8">
        {work.data.description}
      </p>

      <div class="mb-12 rounded-2xl overflow-hidden border border-slate-800">
        <Image
          src={work.data.cover}
          alt={work.data.title}
          width={1200}
          height={900}
          loading="eager"
          fetchpriority="high"
          quality={85}
          format="webp"
        />
      </div>

      <div class="prose prose-invert prose-lg max-w-none mb-12">
         {work.body && <Fragment set:html={work.body} />}
      </div>

      {work.data.before && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6">Estado inicial</h2>
          <div class="rounded-xl overflow-hidden border border-slate-800">
            <Image
              src={work.data.before}
              alt={`${work.data.title} - Antes de la reparación`}
              width={800}
              height={600}
              loading="lazy"
              quality={80}
              format="webp"
            />
          </div>
        </section>
      )}

      <div class="bg-linear-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-2xl p-8 text-center">
        <h2 class="text-2xl font-bold mb-4">¿Necesitas reparar tu celular?</h2>
        <p class="text-slate-300 mb-6">Obtén el mismo servicio profesional</p>
        <a href="/#contact" class="inline-block bg-linear-to-r from-green-500 to-blue-600 px-8 py-3 rounded-full font-semibold hover:scale-105 transition-transform">
          Contactar ahora
        </a>
      </div>
    </article>
  </main>
</Layout>